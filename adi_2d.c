
/* Name : 
Roll no : 
Problem Statement : write a C programme  to find the numerical solution of the mixed boundary value problem 
U_xx+U_yy = 4x-2y , in the square whose vertices are at the points (0,0), (1,0), (0,1),(1,1) , with 
the boundary conditions ,
u(x,0)=2x
u(x,1)=2x-1 ; 0<=x<=1

u(0,y)+U_x(0,y)=2-y
u(1,y)=2-y ; 0<=y<=1

Use line/point Gauss-Seidel iterative method with h=k=0.1*/



#include<stdio.h>
#include<math.h>
#include<stdlib.h>


#define N 10
#define M 10
#define MAX_ITER 1000
#define Tol 1e-5
#define h 0.1
#define k 0.1

void initialize( double u[N+1][M+1])
{ for(int i=0;i<=N;i++)
{  double x=i*h;
   u[i][0]=2*x;
   u[i][M]=2*x-1;}
   for(int j=0;j<=M ;j++)
   {  double y=j*h;
      u[N][j]=2-y;}}
      
void apply_mixed_boundary( double u[N+1][M+1] )
{  for(int j=1;j<M;j++)
   {  double y=j*h;
      u[0][j]=(2-y-u[1][j])/(1-1/h);}}
      
      
void gauss_seidel( double u[N+1][M+1])
{  double error;
   int iter =0;
   do{
   error=0.0;
   for(int i=1;i<N;i++)
   {  for(int j=1;j<M;j++)
      {  double x=i*h, y=j*h;
         double rhs = 4*x-2*y;
         double new_u=0.25*(u[i+1][j]+u[i-1][j]+u[i][j+1]+u[i][j-1] -h*h*rhs);
         double diff= fabs(new_u-u[i][j]);
         if( diff>error)
         {  error=diff;}
         u[i][j]=new_u;}}
         apply_mixed_boundary(u);
         iter++;
         } while( error > Tol && iter < MAX_ITER);}
         
         
         
 void print_solution( double u[N+1][M+1])
 { printf("\t x \t y \t u(x,y) \n ");
   for(int j=0;j<=M;j++)
   {  for(int i=0;i<=N;i++)
   {  printf("\t %0.2f \t %0.2f \t %0.6f ",i*h,j*k,u[i][j]);
      printf("\n");}
      printf("\n");}
      }
      
      
 int main()
 { double u[N+1][M+1]={0};
 initialize(u);
 gauss_seidel(u);
 printf("\n Numerical solution u(x,y):\n");
 print_solution(u);
 print("\n\n All values are correct upto 6 decimal places");
 return 0;}
 

***************** OUTPUT ****************


Numerical solution u(x,y):
	 x 	 y 	 u(x,y) 
 	 0.00 	 0.00 	 0.000000 
	 0.10 	 0.00 	 0.200000 
	 0.20 	 0.00 	 0.400000 
	 0.30 	 0.00 	 0.600000 
	 0.40 	 0.00 	 0.800000 
	 0.50 	 0.00 	 1.000000 
	 0.60 	 0.00 	 1.200000 
	 0.70 	 0.00 	 1.400000 
	 0.80 	 0.00 	 1.600000 
	 0.90 	 0.00 	 1.800000 
	 1.00 	 0.00 	 2.000000 

	 0.00 	 0.10 	 -0.202158 
	 0.10 	 0.10 	 0.080578 
	 0.20 	 0.10 	 0.299706 
	 0.30 	 0.10 	 0.497521 
	 0.40 	 0.10 	 0.688155 
	 0.50 	 0.10 	 0.877275 
	 0.60 	 0.10 	 1.067802 
	 0.70 	 0.10 	 1.261898 
	 0.80 	 0.10 	 1.462007 
	 0.90 	 0.10 	 1.672038 
	 1.00 	 0.10 	 1.900000 

	 0.00 	 0.20 	 -0.197026 
	 0.10 	 0.20 	 0.026768 
	 0.20 	 0.20 	 0.226733 
	 0.30 	 0.20 	 0.412233 
	 0.40 	 0.20 	 0.591834 
	 0.50 	 0.20 	 0.771154 
	 0.60 	 0.20 	 0.954045 
	 0.70 	 0.20 	 1.143789 
	 0.80 	 0.20 	 1.344094 
	 0.90 	 0.20 	 1.560148 
	 1.00 	 0.20 	 1.800000 

	 0.00 	 0.30 	 -0.189245 
	 0.10 	 0.30 	 -0.003203 
	 0.20 	 0.30 	 0.172238 
	 0.30 	 0.30 	 0.340857 
	 0.40 	 0.30 	 0.507810 
	 0.50 	 0.30 	 0.677476 
	 0.60 	 0.30 	 0.853447 
	 0.70 	 0.30 	 1.039130 
	 0.80 	 0.30 	 1.238439 
	 0.90 	 0.30 	 1.456463 
	 1.00 	 0.30 	 1.700000 

	 0.00 	 0.40 	 -0.180507 
	 0.10 	 0.40 	 -0.024564 
	 0.20 	 0.40 	 0.126581 
	 0.30 	 0.40 	 0.277166 
	 0.40 	 0.40 	 0.431092 
	 0.50 	 0.40 	 0.591511 
	 0.60 	 0.40 	 0.761151 
	 0.70 	 0.40 	 0.942855 
	 0.80 	 0.40 	 1.140078 
	 0.90 	 0.40 	 1.357265 
	 1.00 	 0.40 	 1.600000 

	 0.00 	 0.50 	 -0.171680 
	 0.10 	 0.50 	 -0.045116 
	 0.20 	 0.50 	 0.081500 
	 0.30 	 0.50 	 0.214152 
	 0.40 	 0.50 	 0.355900 
	 0.50 	 0.50 	 0.508344 
	 0.60 	 0.50 	 0.672809 
	 0.70 	 0.50 	 0.851072 
	 0.80 	 0.50 	 1.045760 
	 0.90 	 0.50 	 1.260523 
	 1.00 	 0.50 	 1.500000 

	 0.00 	 0.60 	 -0.163523 
	 0.10 	 0.60 	 -0.071709 
	 0.20 	 0.60 	 0.028397 
	 0.30 	 0.60 	 0.144061 
	 0.40 	 0.60 	 0.276031 
	 0.50 	 0.60 	 0.423172 
	 0.60 	 0.60 	 0.584683 
	 0.70 	 0.60 	 0.760878 
	 0.80 	 0.60 	 0.953372 
	 0.90 	 0.60 	 1.165069 
	 1.00 	 0.60 	 1.400000 

	 0.00 	 0.70 	 -0.157176 
	 0.10 	 0.70 	 -0.114584 
	 0.20 	 0.70 	 -0.044249 
	 0.30 	 0.70 	 0.057677 
	 0.40 	 0.70 	 0.185009 
	 0.50 	 0.70 	 0.331646 
	 0.60 	 0.70 	 0.493888 
	 0.70 	 0.70 	 0.670393 
	 0.80 	 0.70 	 0.861788 
	 0.90 	 0.70 	 1.070382 
	 1.00 	 0.70 	 1.300000 

	 0.00 	 0.80 	 -0.155021 
	 0.10 	 0.80 	 -0.195193 
	 0.20 	 0.80 	 -0.154477 
	 0.30 	 0.80 	 -0.056099 
	 0.40 	 0.80 	 0.076692 
	 0.50 	 0.80 	 0.230528 
	 0.60 	 0.80 	 0.398837 
	 0.70 	 0.80 	 0.579026 
	 0.80 	 0.80 	 0.771008 
	 0.90 	 0.80 	 0.976673 
	 1.00 	 0.80 	 1.200000 

	 0.00 	 0.90 	 -0.163187 
	 0.10 	 0.90 	 -0.368686 
	 0.20 	 0.90 	 -0.330362 
	 0.30 	 0.90 	 -0.208281 
	 0.40 	 0.90 	 -0.052662 
	 0.50 	 0.90 	 0.118944 
	 0.60 	 0.90 	 0.299913 
	 0.70 	 0.90 	 0.487871 
	 0.80 	 0.90 	 0.682546 
	 0.90 	 0.90 	 0.885305 
	 1.00 	 0.90 	 1.100000 

	 0.00 	 1.00 	 -1.000000 
	 0.10 	 1.00 	 -0.800000 
	 0.20 	 1.00 	 -0.600000 
	 0.30 	 1.00 	 -0.400000 
	 0.40 	 1.00 	 -0.200000 
	 0.50 	 1.00 	 0.000000 
	 0.60 	 1.00 	 0.200000 
	 0.70 	 1.00 	 0.400000 
	 0.80 	 1.00 	 0.600000 
	 0.90 	 1.00 	 0.800000 
	 1.00 	 1.00 	 1.000000 

(All values are correct upto 6 decimal places )
         
       
